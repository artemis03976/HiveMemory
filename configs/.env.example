# HiveMemory 环境配置示例
#
# 复制此文件为 .env 并填入实际值
# 所有环境变量使用 HIVEMEMORY__ 前缀，嵌套配置使用双下划线 __ 分隔

# ======================
# 系统配置
# ======================
HIVEMEMORY__SYSTEM__NAME=HiveMemory
HIVEMEMORY__SYSTEM__VERSION=0.1.0
HIVEMEMORY__SYSTEM__DEBUG=false

# 日志配置
HIVEMEMORY__LOGGING__LEVEL=INFO
HIVEMEMORY__LOGGING__FILE_PATH=null
HIVEMEMORY__LOGGING__CONSOLE_OUTPUT=true

# ======================
# LLM 配置
# ======================

# Worker LLM (用户交互代理)
HIVEMEMORY__LLM__WORKER__PROVIDER=litellm
HIVEMEMORY__LLM__WORKER__MODEL=gpt-4o
HIVEMEMORY__LLM__WORKER__API_KEY=your_openai_api_key_here
HIVEMEMORY__LLM__WORKER__API_BASE=https://api.openai.com/v1
HIVEMEMORY__LLM__WORKER__TEMPERATURE=0.7
HIVEMEMORY__LLM__WORKER__MAX_TOKENS=4096

# Librarian LLM (Patchouli 记忆管理)
HIVEMEMORY__LLM__LIBRARIAN__PROVIDER=litellm
HIVEMEMORY__LLM__LIBRARIAN__MODEL=deepseek/deepseek-chat
HIVEMEMORY__LLM__LIBRARIAN__API_KEY=your_deepseek_api_key_here
HIVEMEMORY__LLM__LIBRARIAN__API_BASE=https://api.deepseek.com
HIVEMEMORY__LLM__LIBRARIAN__TEMPERATURE=0.3
HIVEMEMORY__LLM__LIBRARIAN__MAX_TOKENS=8192

# ======================
# Embedding 配置
# ======================
HIVEMEMORY__EMBEDDING__MODEL_NAME=BAAI/bge-m3
HIVEMEMORY__EMBEDDING__DEVICE=cpu
HIVEMEMORY__EMBEDDING__CACHE_DIR=null
HIVEMEMORY__EMBEDDING__BATCH_SIZE=32
HIVEMEMORY__EMBEDDING__NORMALIZE_EMBEDDINGS=true
HIVEMEMORY__EMBEDDING__DIMENSION=1024

# ======================
# 数据库配置
# ======================

# Qdrant 向量数据库
HIVEMEMORY__QDRANT__HOST=localhost
HIVEMEMORY__QDRANT__PORT=6333
HIVEMEMORY__QDRANT__GRPC_PORT=6334
HIVEMEMORY__QDRANT__API_KEY=null
HIVEMEMORY__QDRANT__COLLECTION_NAME=hivememory_main
HIVEMEMORY__QDRANT__VECTOR_DIMENSION=1024
HIVEMEMORY__QDRANT__DISTANCE_METRIC=Cosine
HIVEMEMORY__QDRANT__ON_DISK_PAYLOAD=false

# Redis 配置
HIVEMEMORY__REDIS__HOST=localhost
HIVEMEMORY__REDIS__PORT=6379
HIVEMEMORY__REDIS__PASSWORD=your_redis_password_here
HIVEMEMORY__REDIS__DB=0
HIVEMEMORY__REDIS__DECODE_RESPONSES=true

# ======================
# 感知层配置 (Perception)
# ======================

# 感知层类型选择
HIVEMEMORY__PERCEPTION__LAYER_TYPE=semantic_flow
HIVEMEMORY__PERCEPTION__ENABLE=true

# SemanticFlowPerceptionLayer 配置
HIVEMEMORY__PERCEPTION__SEMANTIC_FLOW__IDLE_TIMEOUT_SECONDS=900
HIVEMEMORY__PERCEPTION__SEMANTIC_FLOW__SCAN_INTERVAL_SECONDS=30
HIVEMEMORY__PERCEPTION__SEMANTIC_FLOW__SEMANTIC_THRESHOLD=0.6
HIVEMEMORY__PERCEPTION__SEMANTIC_FLOW__SHORT_TEXT_THRESHOLD=50
HIVEMEMORY__PERCEPTION__SEMANTIC_FLOW__EMA_ALPHA=0.3
HIVEMEMORY__PERCEPTION__SEMANTIC_FLOW__MAX_PROCESSING_TOKENS=8192
HIVEMEMORY__PERCEPTION__SEMANTIC_FLOW__ENABLE_SMART_SUMMARY=false

# SimplePerceptionLayer 配置
HIVEMEMORY__PERCEPTION__SIMPLE__MESSAGE_THRESHOLD=6
HIVEMEMORY__PERCEPTION__SIMPLE__TIMEOUT_SECONDS=900
HIVEMEMORY__PERCEPTION__SIMPLE__ENABLE_SEMANTIC_TRIGGER=true

# ======================
# 记忆生成配置 (Generation)
# ======================

# LLM 提取器配置
HIVEMEMORY__GENERATION__EXTRACTOR__MAX_RETRIES=2
HIVEMEMORY__GENERATION__EXTRACTOR__TEMPERATURE=null
HIVEMEMORY__GENERATION__EXTRACTOR__MAX_TOKENS=null
HIVEMEMORY__GENERATION__EXTRACTOR__SYSTEM_PROMPT=null
HIVEMEMORY__GENERATION__EXTRACTOR__USER_PROMPT=null

# 价值评估器配置
HIVEMEMORY__GENERATION__GATER__GATER_TYPE=rule
HIVEMEMORY__GENERATION__GATER__MIN_TOTAL_LENGTH=20
HIVEMEMORY__GENERATION__GATER__MIN_SUBSTANTIVE_LENGTH=10

# 查重器配置
HIVEMEMORY__GENERATION__DEDUPLICATOR__HIGH_SIMILARITY_THRESHOLD=0.95
HIVEMEMORY__GENERATION__DEDUPLICATOR__LOW_SIMILARITY_THRESHOLD=0.75
HIVEMEMORY__GENERATION__DEDUPLICATOR__CONTENT_SIMILARITY_THRESHOLD=0.9
HIVEMEMORY__GENERATION__DEDUPLICATOR__ENABLE_VITALITY_TRACKING=true

# ======================
# 记忆检索配置 (Retrieval)
# ======================

# 顶层配置
HIVEMEMORY__RETRIEVAL__ENABLE_ROUTING=true

# 路由器配置
HIVEMEMORY__RETRIEVAL__ROUTER__ROUTER_TYPE=simple
HIVEMEMORY__RETRIEVAL__ROUTER__MIN_QUERY_LENGTH=3
HIVEMEMORY__RETRIEVAL__ROUTER__MIN_KEYWORD_COUNT=1

# 查询处理器配置
HIVEMEMORY__RETRIEVAL__PROCESSOR__ENABLE_TIME_PARSING=true
HIVEMEMORY__RETRIEVAL__PROCESSOR__ENABLE_TYPE_DETECTION=true
HIVEMEMORY__RETRIEVAL__PROCESSOR__ENABLE_QUERY_EXPANSION=true
HIVEMEMORY__RETRIEVAL__PROCESSOR__ENABLE_LLM_REWRITE=false

# 渲染器配置
HIVEMEMORY__RETRIEVAL__RENDERER__RENDER_FORMAT=xml
HIVEMEMORY__RETRIEVAL__RENDERER__MAX_TOKENS=2000
HIVEMEMORY__RETRIEVAL__RENDERER__MAX_CONTENT_LENGTH=500
HIVEMEMORY__RETRIEVAL__RENDERER__INCLUDE_METADATA=true
HIVEMEMEMORY__RETRIEVAL__RENDERER__INCLUDE_CONFIDENCE=true
HIVEMEMORY__RETRIEVAL__RENDERER__INCLUDE_TIMESTAMP=true
HIVEMEMORY__RETRIEVAL__RENDERER__INCLUDE_ARTIFACT=false
HIVEMEMORY__RETRIEVAL__RENDERER__CONFIDENCE_THRESHOLD=0.5
HIVEMEMORY__RETRIEVAL__RENDERER__OLD_MEMORY_DAYS=90

# 混合检索配置
HIVEMEMORY__RETRIEVAL__RETRIEVER__TOP_K=5
HIVEMEMORY__RETRIEVAL__RETRIEVER__SCORE_THRESHOLD=0.75
HIVEMEMORY__RETRIEVAL__RETRIEVER__ENABLE_HYBRID_SEARCH=true
HIVEMEMORY__RETRIEVAL__RETRIEVER__ENABLE_PARALLEL=true

# 稠密检索配置
HIVEMEMORY__RETRIEVAL__RETRIEVER__DENSE__ENABLED=true
HIVEMEMORY__RETRIEVAL__RETRIEVER__DENSE__TOP_K=50
HIVEMEMORY__RETRIEVAL__RETRIEVER__DENSE__SCORE_THRESHOLD=0.0
HIVEMEMORY__RETRIEVAL__RETRIEVER__DENSE__ENABLE_TIME_DECAY=true
HIVEMEMORY__RETRIEVAL__RETRIEVER__DENSE__TIME_DECAY_DAYS=30
HIVEMEMORY__RETRIEVAL__RETRIEVER__DENSE__ENABLE_CONFIDENCE_BOOST=true

# 稀疏检索配置
HIVEMEMORY__RETRIEVAL__RETRIEVER__SPARSE__ENABLED=true
HIVEMEMORY__RETRIEVAL__RETRIEVER__SPARSE__TOP_K=50
HIVEMEMORY__RETRIEVAL__RETRIEVER__SPARSE__SCORE_THRESHOLD=0.0

# 融合配置
HIVEMEMORY__RETRIEVAL__RETRIEVER__FUSION__RRF_K=60
HIVEMEMORY__RETRIEVAL__RETRIEVER__FUSION__DENSE_WEIGHT=1.0
HIVEMEMORY__RETRIEVAL__RETRIEVER__FUSION__SPARSE_WEIGHT=1.0
HIVEMEMORY__RETRIEVAL__RETRIEVER__FUSION__FINAL_TOP_K=5

# 重排序配置
HIVEMEMORY__RETRIEVAL__RETRIEVER__RERANKER__ENABLED=true
HIVEMEMORY__RETRIEVAL__RETRIEVER__RERANKER__TYPE=cross_encoder
HIVEMEMORY__RETRIEVAL__RETRIEVER__RERANKER__MODEL_NAME=BAAI/bge-reranker-v2-m3
HIVEMEMORY__RETRIEVAL__RETRIEVER__RERANKER__DEVICE=cpu
HIVEMEMORY__RETRIEVAL__RETRIEVER__RERANKER__USE_FP16=true
HIVEMEMORY__RETRIEVAL__RETRIEVER__RERANKER__BATCH_SIZE=32
HIVEMEMORY__RETRIEVAL__RETRIEVER__RERANKER__TOP_K=20
HIVEMEMORY__RETRIEVAL__RETRIEVER__RERANKER__NORMALIZE_SCORES=true

# ======================
# 记忆生命周期配置 (Lifecycle)
# ======================

# 生命力计算器配置
HIVEMEMORY__LIFECYCLE__VITALITY_CALCULATOR__CODE_SNIPPET_WEIGHT=1.0
HIVEMEMORY__LIFECYCLE__VITALITY_CALCULATOR__FACT_WEIGHT=0.9
HIVEMEMORY__LIFECYCLE__VITALITY_CALCULATOR__URL_RESOURCE_WEIGHT=0.8
HIVEMEMORY__LIFECYCLE__VITALITY_CALCULATOR__REFLECTION_WEIGHT=0.7
HIVEMEMORY__LIFECYCLE__VITALITY_CALCULATOR__USER_PROFILE_WEIGHT=0.6
HIVEMEMORY__LIFECYCLE__VITALITY_CALCULATOR__WORK_IN_PROGRESS_WEIGHT=0.5
HIVEMEMORY__LIFECYCLE__VITALITY_CALCULATOR__DEFAULT_WEIGHT=0.5
HIVEMORY__LIFECYCLE__VITALITY_CALCULATOR__MAX_ACCESS_BOOST=20.0
HIVEMORY__LIFECYCLE__VITALITY_CALCULATOR__POINTS_PER_ACCESS=2.0
HIVEMEMORY__LIFECYCLE__VITALITY_CALCULATOR__DECAY_LAMBDA=0.01

# 强化引擎配置
HIVEMEMORY__LIFECYCLE__REINFORCEMENT_ENGINE__ENABLE_EVENT_HISTORY=true
HIVEMEMORY__LIFECYCLE__REINFORCEMENT_ENGINE__EVENT_HISTORY_LIMIT=10000
HIVEMEMORY__LIFECYCLE__REINFORCEMENT_ENGINE__HIT_BOOST=5.0
HIVEMEMORY__LIFECYCLE__REINFORCEMENT_ENGINE__CITATION_BOOST=20.0
HIVEMEMORY__LIFECYCLE__REINFORCEMENT_ENGINE__POSITIVE_FEEDBACK_BOOST=50.0
HIVEMEMORY__LIFECYCLE__REINFORCEMENT_ENGINE__NEGATIVE_FEEDBACK_PENALTY=-50.0
HIVEMEMORY__LIFECYCLE__REINFORCEMENT_ENGINE__NEGATIVE_CONFIDENCE_MULTIPLIER=0.5

# 归档器配置
HIVEMORY__LIFECYCLE__ARCHIVER__ARCHIVE_DIR=data/archived
HIVEMORY__LIFECYCLE__ARCHIVER__COMPRESSION=true

# 垃圾回收器配置
HIVEMORY__LIFECYCLE__GARBAGE_COLLECTOR__LOW_WATERMARK=20.0
HIVEMORY__LIFECYCLE__GARBAGE_COLLECTOR__BATCH_SIZE=10
HIVEMORY__LIFECYCLE__GARBAGE_COLLECTOR__ENABLE_SCHEDULE=false
HIVEMORY__LIFECYCLE__GARBAGE_COLLECTOR__INTERVAL_HOURS=24

# 高水位阈值
HIVEMEMORY__LIFECYCLE__HIGH_WATERMARK=80.0
